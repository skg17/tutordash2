<% submit_text = local_assigns.fetch(:submit_text, 'Save Student') %>

<div class="card-shadow bg-white p-6 md:p-10 rounded-3xl border border-gray-100 max-w-3xl mx-auto">

    <div class="flex items-center mb-8 pb-4 border-b border-gray-100">
        <div class="icon mr-3 text-purple-600" data-lucide="user-plus" style="width: 24px; height: 24px;"></div>
        <div>
            <h2 class="text-xl font-bold text-gray-900">Student Information</h2>
            <p class="text-sm text-gray-500">Enter the student's essential details.</p>
        </div>
    </div>

    <%= form_with(model: student, class: "space-y-6") do |form| %>

        <div>
            <%= form.label :name, "Student's Name", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :name, placeholder: "Emma Wilson", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
        </div>
        
        <div>
            <%= form.label :parent_name, "Parent's Name", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :parent_name, placeholder: "Adam Smith", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <%= form.label :email, "Email", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= form.email_field :email, placeholder: "emma.wilson@email.com", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
            </div>

            <div>
                <%= form.label :phone, "Phone Number", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= form.text_field :phone, placeholder: "+1 (555) 123-4567", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
            </div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <%= form.label :year, "Year Group", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <div class="relative">
                    <%# Create an array of arrays: [["Year 7", 7], ["Year 8", 8], ...] %>
                    <% year_options = (7..13).map { |y| ["Year #{y}", y] } %>

                    <%= form.select :year, 
                                    options_for_select(year_options, student.year), 
                                    { prompt: "Select year" }, 
                                    class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white appearance-none pr-10 transition duration-150" %>
                    <div class="icon absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none" data-lucide="chevron-down" style="width: 20px; height: 20px;"></div>
                </div>
            </div>

            <div>
                <%= form.label :subjects, "Subjects", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%# We convert the subjects array back to a comma-separated string for editing %>
                <%= form.text_field :subjects, value: student.subjects.is_a?(Array) ? student.subjects.join(', ') : student.subjects, placeholder: "e.g. Maths, Physics (comma-separated)", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
                <%= form.label :rate, "Hourly Rate (Â£)", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= form.number_field :rate, placeholder: "e.g. 35.00", step: "0.01", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
            </div>
            <div>
                <%= form.label :grade, "Working Grade", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= form.text_field :grade, placeholder: "e.g. A-", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
            </div>
            <div>
                <%= form.label :target, "Target Grade", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= form.text_field :target, placeholder: "e.g. A*", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
            </div>
        </div>

        <div class="pt-6 border-t border-gray-100"></div>

        <div class="flex justify-end space-x-4">
            
            <%= link_to "Cancel", students_path, class: "px-6 py-3 text-sm font-semibold rounded-xl text-gray-700 border border-gray-300 hover:bg-gray-100 transition duration-150 text-center" %>

            <%= form.submit submit_text, class: "px-6 py-3 text-sm font-semibold rounded-xl bg-purple-600 text-white shadow-lg hover:bg-purple-700 transition duration-150 cursor-pointer" %>
        </div>

    <% end %>

</div>