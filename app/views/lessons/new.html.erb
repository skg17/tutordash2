<!-- The content below will be yielded into the <main> tag of application.html.erb -->

<!-- Back Button and Page Title -->
<section class="mb-8">
    <%= link_to lessons_path, class: "flex items-center text-lg font-semibold text-gray-700 hover:text-purple-600 transition duration-150 mb-4" do %>
        <div class="icon mr-2" data-lucide="arrow-left" style="width: 20px; height: 20px;"></div>
        <span class="text-sm uppercase tracking-wider">Back to Lessons</span>
    <% end %>

    <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-1">Schedule New Lesson</h1>
    <p class="text-gray-500">Set up a new tutoring session.</p>
</section>

<!-- Form Card Wrapper -->
<!-- ADDED max-w-3xl mx-auto to match the student form width -->
<div class="card-shadow bg-white p-6 md:p-10 rounded-3xl border border-gray-100 max-w-3xl mx-auto">

    <!-- Section Header -->
    <div class="flex items-center mb-8 pb-4 border-b border-gray-100">
        <div class="icon mr-3 text-purple-600" data-lucide="plus" style="width: 24px; height: 24px;"></div>
        <div>
            <h2 class="text-xl font-bold text-gray-900">Lesson Details</h2>
            <p class="text-sm text-gray-500">Fill in the lesson information</p>
        </div>
    </div>

    <%= form_with(model: @lesson, class: "space-y-6") do |form| %>

        <!-- Row 1: Student and Subject -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <%= form.label :student_id, "Student", class: "block text-sm font-medium text-gray-700 mb-2" %>
                
                <div class="relative">
                <%= form.collection_select(
                    :student_id,             # 1. The Lesson attribute (foreign key) to set
                    @students,               # 2. The collection of students (loaded from the controller)
                    :id,                     # 3. The method to call for the VALUE attribute (the student's ID)
                    :name,                   # 4. The method to call for the displayed text (the student's name)
                    { prompt: "Select a Student" }, # Options: add a placeholder/prompt
                    {                        # HTML attributes: apply the Tailwind classes
                        class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white appearance-none pr-10 transition duration-150",
                        required: true         # Enforce selection
                    }
                ) %>
                <div class="icon absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none" data-lucide="chevron-down" style="width: 20px; height: 20px;"></div>
                </div>
            </div>

            <div>
                <%= form.label :subject, "Subject", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <%= form.text_field :subject, placeholder: "e.g. Mathematics", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
            </div>
        </div>

        <!-- Row 2: Date/Time, Duration, and Paid Status -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <%= form.label :date, "Date & Time", class: "block text-sm font-medium text-gray-700 mb-2" %>
                <!-- Using form.datetime_field for combined date and time inputs -->
                <div class="relative flex items-center">
                    <%= form.datetime_field :date, class: "w-full p-3 pr-10 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150" %>
                    <div class="icon absolute right-3 text-gray-500 pointer-events-none" data-lucide="clock" style="width: 20px; height: 20px;"></div>
                </div>
            </div>
            
            <!-- Duration & Paid Status Wrapper -->
            <!-- Use a nested grid/flex to align duration and paid status horizontally on desktop -->
            <div class="grid grid-cols-3 gap-4">
                
                <!-- Duration Select Box (2/3 width) -->
                <div class="relative col-span-2">
                    <%= form.label :duration, "Duration", class: "block text-sm font-medium text-gray-700 mb-2" %>
                    <%= form.select :duration, [['60 Minutes', 1], ['90 Minutes', 1.5], ['120 Minutes', 2]], { prompt: "Select duration" }, class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white appearance-none pr-10 transition duration-150" %>
                    <div class="icon absolute right-3 top-[calc(50%+16px)] -translate-y-1/2 text-gray-500 pointer-events-none" data-lucide="chevron-down" style="width: 20px; height: 20px;"></div>
                </div>
                
                <!-- Paid Status Dropdown (1/3 width) -->
                <div class="relative col-span-1">
                    <%= form.label :paid, "Paid", class: "block text-sm font-medium text-gray-700 mb-2" %>
                    <%= form.select :paid, [['Yes', true], ['No', false]], { prompt: "Select" }, class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white appearance-none pr-8 transition duration-150" %>
                    <div class="icon absolute right-3 top-[calc(50%+16px)] -translate-y-1/2 text-gray-500 pointer-events-none" data-lucide="chevron-down" style="width: 18px; height: 18px;"></div>
                </div>
            </div>
        </div>

        <!-- Full Width Row: Homework Text Area -->
        <div>
            <%= form.label :homework, "Homework / Notes", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_area :homework, placeholder: "Enter homework assigned or any notes for the lesson...", class: "w-full p-3 border-none rounded-xl bg-purple-100/50 text-gray-800 focus:ring-2 focus:ring-purple-500 focus:bg-white transition duration-150 h-24 resize-none" %>
        </div>
        
        <!-- Separator for Buttons -->
        <div class="pt-6 border-t border-gray-100"></div>

        <!-- Button Row: Cancel and Schedule Lesson -->
        <div class="flex justify-end space-x-4">

            <!-- Cancel Button (Secondary) -->
            <%= link_to "Cancel", lessons_path, class: "px-6 py-3 text-sm font-semibold rounded-xl text-gray-700 border border-gray-300 hover:bg-gray-100 transition duration-150 text-center" %>

            <!-- Submit Button (Primary) -->
            <%= form.submit "Schedule Lesson", class: "px-6 py-3 text-sm font-semibold rounded-xl bg-purple-600 text-white shadow-lg hover:bg-purple-700 transition duration-150 cursor-pointer" %>
        </div>

    <% end %>

</div>